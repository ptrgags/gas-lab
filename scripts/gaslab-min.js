var gasLab={COLOR_WHITE:"#FFFFFF",STAGE_HEIGHT:480,STAGE_WIDTH:640,MIN_HEIGHT:1,MAX_HEIGHT:10,STEP_HEIGHT:1,MIN_TEMP:290,MAX_TEMP:400,STEP_TEMP:10,MIN_MOLS:0.1,MAX_MOLS:1,STEP_MOLS:0.1,MAX_VOLUME:1E4,MAX_PRESSURE:0.033,PX_PER_METER:40,GAS_CONSTANT:0.08206,MIN_OPACITY:0.1,OPACITY_GRADIENT:0.9,COLOR_GRADIENT:255,height:10,volume:1E4,molecules:0.1,temperature:290,pressure:2.37E-4,setHeight:function(e){gasLab.height=e;gasLab.volume=1E3*e;gasLab.calcPressure()},setMolecules:function(e){var b=gasLab.molecules;
gasLab.molecules=e;gasLab.calcVolume(e>b)},setTemperature:function(e){var b=gasLab.temperature;gasLab.temperature=e;gasLab.calcVolume(e>b)},calcPressure:function(){gasLab.pressure=gasLab.molecules*gasLab.GAS_CONSTANT*gasLab.temperature/gasLab.volume},getPV:function(){return gasLab.pressure*gasLab.volume},getNRT:function(){return gasLab.molecules*gasLab.GAS_CONSTANT*gasLab.temperature},calcVolume:function(e){gasLab.volume=gasLab.molecules*gasLab.GAS_CONSTANT*gasLab.temperature/gasLab.pressure;gasLab.volume>
gasLab.MAX_VOLUME&&(gasLab.volume=gasLab.MAX_VOLUME,gasLab.calcPressure());gasLab.calcHeight()},calcHeight:function(){gasLab.height=gasLab.volume/1E3;$("#height").val(gasLab.height.toFixed(0))}},init=function(){var e=new createjs.Stage("stage");gasLab.stage=e;var b=new Chamber;gasLab.chamber=b;b=new Piston;gasLab.piston=b;b=new VolumeTracker;gasLab.volTracker=b;b=new Gas;gasLab.gas=b;b=new Gauges;gasLab.gauges=b;b=new Flames;gasLab.flames=b;changeHeight();gasLab.calcPressure();e.update()},update=
function(){$("#volumeOut").html(gasLab.volume.toExponential(2));$("#pressureOut").html(gasLab.pressure.toExponential(2));$("#moleculesOut").html(gasLab.molecules.toExponential(2));$("#temperatureOut").html(gasLab.temperature.toExponential(2));$("#leftOut").html(gasLab.getPV().toExponential(2));$("#rightOut").html(gasLab.getNRT().toExponential(2));gasLab.piston.update();gasLab.volTracker.update();gasLab.gas.update();gasLab.gauges.update();gasLab.flames.update();gasLab.stage.update()},reset=function(){$("#height").val(10);
$("#molecules").val(0.1);$("#temperature").val(290);gasLab.height=10;gasLab.molecules=0.1;gasLab.temperature=290;gasLab.calcPressure();changeHeight()},changeHeight=function(){gasLab.setHeight(parseInt($("#height").val(),10)||10);update()},changeMolecules=function(){gasLab.setMolecules(parseFloat($("#molecules").val())||0.1);update()},changeTemperature=function(){gasLab.setTemperature(parseInt($("#temperature").val(),10)||290);update()},Chamber=function(){var e=gasLab.stage,b=gasLab.COLOR_WHITE,a=
new createjs.Shape;a.w=100;a.h=400;a.hOffset=50;a.pointer={x:-20,y:a.h-10};a.x=gasLab.STAGE_WIDTH/2-a.w/2;a.y=gasLab.STAGE_HEIGHT-a.h-a.hOffset;a.graphics.beginStroke(b);a.graphics.moveTo(0,0);a.graphics.lineTo(0,a.h);a.graphics.lineTo(a.w,a.h);a.graphics.lineTo(a.w,0);a.graphics.beginStroke(b);a.graphics.moveTo(0,a.h);a.graphics.lineTo(a.pointer.x,a.pointer.y);e.addChild(a);var c=new createjs.Text;c.text="A = 1.00 m^2";c.color=b;c.x=a.x-68;c.y=a.y+a.h-30;e.addChild(c);this.chamber=a;this.areaLabel=
c;this.x=a.x;this.y=a.y;this.w=a.w;this.h=a.h;this.hOffset=a.hOffset},Piston=function(){var e=gasLab.stage,b=gasLab.chamber;this.update=function(){a.y=b.y+b.h-a.h-gasLab.height*gasLab.PX_PER_METER;var c=a.graphics;c.clear();c.beginStroke(gasLab.COLOR_WHITE);c.drawRect(0,0,a.w,a.h);a.graphics.moveTo(a.w/2,0);a.graphics.lineTo(a.w/2,-a.y)};var a=new createjs.Shape;a.w=b.w-2;a.h=20;a.x=b.x+1;e.addChild(a);this.update();this.piston=a;this.x=a.x;this.y=a.y;this.w=a.w;this.h=a.h},VolumeTracker=function(){var e=
gasLab.stage,b=gasLab.chamber,a=gasLab.COLOR_WHITE;this.update=function(){c.h=gasLab.PX_PER_METER*gasLab.height;this.h=c.h;var b=c.graphics;b.clear();b.beginStroke(a);b.moveTo(0,0);b.lineTo(c.w,0);b.moveTo(c.w/2,0);b.lineTo(c.w/2,-c.h);b.moveTo(0,-c.h);c.graphics.lineTo(c.w,-c.h);d.y=c.y-c.h/2;d.text="h = "+gasLab.height.toPrecision(3)+" m\nV = "+gasLab.volume.toPrecision(3)+" L"};var c=new createjs.Shape;c.w=20;c.x=b.x+b.w+8;c.y=b.y+b.h;e.addChild(c);var d=new createjs.Text;d.x=c.x+c.w;d.color=a;
e.addChild(d);this.update();this.volMarker=c;this.volText=d},Gas=function(){var e=gasLab.stage,b=gasLab.piston,a=gasLab.chamber,c=gasLab.volTracker;this.update=function(){d.h=c.h;d.opacity=gasLab.OPACITY_GRADIENT*gasLab.molecules+gasLab.MIN_OPACITY;var a=Math.floor(gasLab.pressure/gasLab.MAX_PRESSURE*gasLab.COLOR_GRADIENT),e=Math.floor(gasLab.pressure/gasLab.MAX_PRESSURE*(1-gasLab.COLOR_GRADIENT)),h=d.graphics;h.clear();h.beginFill("rgba("+a+", 0, "+e+", "+d.opacity+");");h.drawRect(0,0,b.w,-d.h)};
var d=new createjs.Shape;d.x=b.x;d.y=a.y+a.h;d.w=b.w;e.addChild(d);this.gas=d},Gauges=function(){var e=gasLab.stage;this.update=function(){f.x=b.x+gasLab.pressure/gasLab.MAX_PRESSURE*b.w;g.x=d.x+gasLab.molecules/gasLab.MAX_MOLS*d.w;h.text="P = "+gasLab.pressure.toPrecision(3)+" atm";k.text="n = "+gasLab.molecules.toPrecision(3)+" mol"};var b=new createjs.Shape;b.x=32;b.y=100;b.w=200;b.h=20;var a=b.graphics;a.beginStroke("#FFFFFF");a.drawRect(0,0,b.w,b.h);for(var c=0;10>c;c++)a.beginFill("rgb("+Math.floor(c/
10*gasLab.COLOR_GRADIENT)+", 0, "+Math.floor((1-c/10)*gasLab.COLOR_GRADIENT)+")"),a.drawRect(20*c,0,20,20);e.addChild(b);var d=new createjs.Shape;d.x=b.x;d.y=b.y+100;d.w=b.w;d.h=b.h;a=d.graphics;a.beginStroke("#FFFFFF");a.drawRect(0,0,d.w,d.h);for(c=0;10>c;c++)a.beginFill("rgba(255, 255, 255,"+c/10+");"),a.drawRect(20*c,0,20,20);e.addChild(d);var f=new createjs.Shape;f.x=b.x;f.y=b.y+10;a=f.graphics;a.beginFill("#FFFFFF");a.moveTo(0,0);a.lineTo(4,15);a.lineTo(-4,15);a.lineTo(0,0);e.addChild(f);var g=
f.clone(!0);g.y=d.y+10;e.addChild(g);var h=new createjs.Text;h.x=b.x;h.color="#FFFFFF";h.y=b.y+b.h+10;e.addChild(h);var k=new createjs.Text;k.x=d.x;k.color="#FFFFFF";k.y=d.y+d.h+10;e.addChild(k);this.pressureGauge=b;this.moleculeGauge=d;this.cursor1=f;this.cursor2=g},Flames=function(){var e=gasLab.stage,b=gasLab.chamber;this.update=function(){g.text="T = "+gasLab.temperature.toPrecision(3)+" K";var a="rgb("+Math.floor(gasLab.temperature/gasLab.MAX_TEMP*256)+", 0, 0);",b;for(b in c)this.drawFlame(c[b],
a)};this.drawFlame=function(b,c){var d=b.graphics;d.clear();d.beginStroke("#FFFFFF");d.beginFill(c);d.arc(0,0,a.w/2,0,Math.PI);d.lineTo(0,-a.h);d.lineTo(a.w/2,0)};var a=new createjs.Shape;a.h=20;a.w=b.w/8;a.y=b.y+b.h+a.h;for(var c=[],d=0;8>d;d++){var f=a.clone(!0);f.x=b.x+a.w/2+a.w*d;e.addChild(f);c[d]=f}var g=new createjs.Text;g.x=b.x;g.y=a.y+10;g.color="#FFFFFF";e.addChild(g)};window.onload=init;